#include "mbed.h"
#include "test_env.h"

int main() {
    MBED_HOSTTEST_TIMEOUT(20);
    MBED_HOSTTEST_SELECT(serial_nc_rx_auto);
    MBED_HOSTTEST_DESCRIPTION(Serial NC RX);
    MBED_HOSTTEST_START("MBED_37");

    Serial *pc = new Serial(NC, USBRX); // NC

    char c = pc->getc();

    delete pc;

    // This should be true
  //  if (c == 'E') {
      Serial *pc1 = new Serial(USBTX, NC);
      pc1->printf("received c : %c\n",c);
      pc1->printf("RX OK - Expected\r\n");

      c = pc1->getc();

      // This should be false/not get here
      if (c == 'U') {
        pc1->printf("RX OK - Unexpected\r\n");
      }

      delete pc1;
  //  }

    while (1) {
    }
}
